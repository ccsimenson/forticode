{"version":3,"file":"types.js","sourceRoot":"","sources":["types.ts"],"names":[],"mappings":"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","sourcesContent":["export interface LicenseKeyPayload {\n  features: string[];\n  expiryDate?: string; // ISO date string\n  customerId: string;\n  version: string;\n  issuedAt: string; // ISO date string\n  tier: 'free' | 'pro' | 'enterprise';\n}\n\nexport interface LicenseValidationResult {\n  isValid: boolean;\n  error?: string;\n  payload?: LicenseKeyPayload;\n}\n\nexport enum Feature {\n  // Free tier features (always available)\n  BASIC_CSP_VALIDATION = 'basic_csp_validation',\n  INLINE_SCRIPT_DETECTION = 'inline_script_detection',\n  BASIC_GITHUB_INTEGRATION = 'basic_github_integration',\n  BASIC_SECURITY_REPORTS = 'basic_security_reports',\n  TRY_ME_OUT_WIDGET = 'try_me_out_widget',\n  BASIC_PERFORMANCE_METRICS = 'basic_performance_metrics',\n  \n  // Pro tier features\n  ADVANCED_CSP_ANALYSIS = 'advanced_csp_analysis',\n  AUTOMATED_FIX_SUGGESTIONS = 'automated_fix_suggestions',\n  FULL_GITHUB_INTEGRATION = 'full_github_integration',\n  COMPLIANCE_REPORTING = 'compliance_reporting',\n  \n  // Enterprise tier features\n  ROLE_BASED_ACCESS_CONTROL = 'role_based_access_control',\n  SELF_HOSTED_DEPLOYMENT = 'self_hosted_deployment',\n  PRIORITY_SUPPORT = 'priority_support',\n  CONSULTING_SERVICES = 'consulting_services',\n  \n  // Legacy features (kept for backward compatibility)\n  BASIC_SCANNING = 'basic_scanning',\n  ADVANCED_VULNERABILITY_SCANNING = 'advanced_vulnerability_scanning',\n  AUTOMATED_REPORTING = 'automated_reporting',\n  TEAM_COLLABORATION = 'team_collaboration',\n  CUSTOM_POLICIES = 'custom_policies',\n  SCHEDULED_SCANS = 'scheduled_scans',\n  API_ACCESS = 'api_access'\n}\n\nexport const FEATURES = {\n  // Free tier features\n  [Feature.BASIC_CSP_VALIDATION]: {\n    name: 'Basic CSP Validation',\n    description: 'Checks for common policy violations',\n    requiresLicense: false,\n    tier: 'free' as const\n  },\n  [Feature.INLINE_SCRIPT_DETECTION]: {\n    name: 'Inline Script Detection',\n    description: 'Flags unsafe-inline issues',\n    requiresLicense: false,\n    tier: 'free' as const\n  },\n  [Feature.BASIC_GITHUB_INTEGRATION]: {\n    name: 'Basic GitHub Integration',\n    description: 'Runs CSP scans on PRs',\n    requiresLicense: false,\n    tier: 'free' as const\n  },\n  [Feature.BASIC_SECURITY_REPORTS]: {\n    name: 'Basic Security Reports',\n    description: 'Generates simple violation summaries',\n    requiresLicense: false,\n    tier: 'free' as const\n  },\n  [Feature.TRY_ME_OUT_WIDGET]: {\n    name: 'Try Me Out Widget',\n    description: 'Interactive CSP tester',\n    requiresLicense: false,\n    tier: 'free' as const\n  },\n  [Feature.BASIC_PERFORMANCE_METRICS]: {\n    name: 'Basic Performance Metrics',\n    description: 'Basic validation speed/memory usage tracking',\n    requiresLicense: false,\n    tier: 'free' as const\n  },\n\n  // Pro tier features\n  [Feature.ADVANCED_CSP_ANALYSIS]: {\n    name: 'Advanced CSP Analysis',\n    description: 'Detects complex CSP weaknesses',\n    requiresLicense: true,\n    tier: 'pro' as const\n  },\n  [Feature.AUTOMATED_FIX_SUGGESTIONS]: {\n    name: 'Automated Fix Suggestions',\n    description: 'AI-driven CSP improvements',\n    requiresLicense: true,\n    tier: 'pro' as const\n  },\n  [Feature.FULL_GITHUB_INTEGRATION]: {\n    name: 'Full GitHub Integration',\n    description: 'Custom security workflows + pull request enforcement',\n    requiresLicense: true,\n    tier: 'pro' as const\n  },\n  [Feature.COMPLIANCE_REPORTING]: {\n    name: 'Compliance Reporting',\n    description: 'Generates audit-ready security compliance reports',\n    requiresLicense: true,\n    tier: 'pro' as const\n  },\n\n  // Enterprise tier features\n  [Feature.ROLE_BASED_ACCESS_CONTROL]: {\n    name: 'Role-Based Access Control',\n    description: 'Enterprise-level permissions for security teams',\n    requiresLicense: true,\n    tier: 'enterprise' as const\n  },\n  [Feature.SELF_HOSTED_DEPLOYMENT]: {\n    name: 'Self-Hosted Deployment',\n    description: 'Allows companies to run FortiCode internally',\n    requiresLicense: true,\n    tier: 'enterprise' as const\n  },\n  [Feature.PRIORITY_SUPPORT]: {\n    name: 'Priority Support',\n    description: 'Direct access for enterprise security professionals',\n    requiresLicense: true,\n    tier: 'enterprise' as const\n  },\n  [Feature.CONSULTING_SERVICES]: {\n    name: 'Consulting Services',\n    description: 'Custom security consulting and implementation',\n    requiresLicense: true,\n    tier: 'enterprise' as const\n  },\n\n  // Legacy features (kept for backward compatibility)\n  [Feature.BASIC_SCANNING]: {\n    name: 'Basic Security Scanning',\n    description: 'Perform basic security scans for common vulnerabilities',\n    requiresLicense: false,\n    tier: 'free' as const\n  },\n  [Feature.ADVANCED_VULNERABILITY_SCANNING]: {\n    name: 'Advanced Vulnerability Scanning',\n    description: 'Advanced vulnerability detection with deeper analysis',\n    requiresLicense: true,\n    tier: 'pro' as const\n  },\n  [Feature.AUTOMATED_REPORTING]: {\n    name: 'Automated Reporting',\n    description: 'Generate and schedule automated security reports',\n    requiresLicense: true,\n    tier: 'pro' as const\n  },\n  [Feature.TEAM_COLLABORATION]: {\n    name: 'Team Collaboration',\n    description: 'Share scan results and collaborate with team members',\n    requiresLicense: true,\n    tier: 'pro' as const\n  },\n  [Feature.CUSTOM_POLICIES]: {\n    name: 'Custom Security Policies',\n    description: 'Define and enforce custom security policies',\n    requiresLicense: true,\n    tier: 'enterprise' as const\n  },\n  [Feature.SCHEDULED_SCANS]: {\n    name: 'Scheduled Scans',\n    description: 'Schedule automated security scans',\n    requiresLicense: true,\n    tier: 'pro' as const\n  },\n  [Feature.API_ACCESS]: {\n    name: 'API Access',\n    description: 'Access security scan results via API',\n    requiresLicense: true,\n    tier: 'enterprise' as const\n  }\n} as const;\n"]}